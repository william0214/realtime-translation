# 產品版本歷史

---

## v1.1.0 (2025-12-15)

### 🐛 Bug 修復
- **修復即時字幕在結束對話時不消失的問題**
  - 問題：點擊「結束對話」後，「即時字幕 偵測中...」的 partial 訊息殘留在 UI 上
  - 修復：在 `stopRecording` 和 `stopHybridRecording` 函數中加入清除 partial 訊息的邏輯
  - 影響範圍：前端 UI（`client/src/pages/Home.tsx`）
  - 相關 Issue：#001

### 📝 文件更新
- 新增測試報告（`TEST_REPORT.md`）
- 新增版本歷史（`VERSION_HISTORY.md`）
- 新增測試程序（`TESTING_PROCEDURE.md`）
- 新增開發時程（`DEVELOPMENT_SCHEDULE.md`）

### 🧪 測試狀態
- 單元測試通過率：89.1%（57/64）
- 已知問題：對話摘要功能測試失敗（3 個測試）
- 效能測試：平均延遲 3.9 秒

---

## v1.0.0 (2025-12-14)

### ✨ 新功能
- **即時雙向翻譯系統**
  - 支援中文與外語即時翻譯
  - 支援 8 種外語（越南語、印尼語、菲律賓語、英文、義大利語、日文、韓文、泰文）
  - 即時字幕顯示（partial transcripts）
  - 語音合成（TTS）播放翻譯結果

- **語音識別（ASR）**
  - 使用 OpenAI Whisper API
  - 支援自動語言檢測
  - 支援強制中文識別模式

- **語音活動檢測（VAD）**
  - 基於音量的 VAD 演算法
  - 自動分段（最長 4 秒）
  - 靜音檢測（500ms 靜音觸發翻譯）

- **對話記錄管理**
  - 建立/結束對話會話
  - 儲存翻譯記錄到資料庫
  - 查詢歷史對話
  - 語言篩選功能
  - 匯出對話記錄（TXT 格式）

- **效能監控**
  - ASR 延遲監控
  - 翻譯延遲監控
  - TTS 延遲監控
  - E2E 延遲監控
  - 瓶頸診斷系統

- **多後端支援**
  - Node.js 後端（tRPC）
  - Go 後端（REST API）
  - Hybrid ASR（WebSocket）

### 🎨 UI/UX
- 雙欄式介面（台灣人 vs 外國人）
- 即時字幕顯示
- 音量指示器
- 狀態指示器（等待語音、偵測到語音、正在辨識、正在翻譯、播放中）
- 語言選擇器
- 後端選擇器
- 對話記錄清除功能
- 對話記錄匯出功能

### 🔧 技術架構
- **前端：** React 19 + TypeScript + Tailwind CSS 4
- **後端：** Express 4 + tRPC 11
- **資料庫：** MySQL（Drizzle ORM）
- **語音識別：** OpenAI Whisper API
- **翻譯：** OpenAI GPT-4o-mini
- **語音合成：** OpenAI TTS API
- **認證：** Manus OAuth

### 📦 相依套件
- `@trpc/client` ^11.6.0
- `@trpc/react-query` ^11.6.0
- `@trpc/server` ^11.6.0
- `react` ^19.0.0
- `react-dom` ^19.0.0
- `drizzle-orm` ^0.38.3
- `openai` ^4.77.3
- `express` ^4.21.2
- `vitest` ^2.1.9

### 🧪 測試覆蓋
- 認證測試
- 語音識別測試
- 多語言翻譯測試（8 種語言）
- 語音合成測試
- 對話管理測試
- 歷史記錄測試
- 效能測試
- WebM 串流測試

### 📊 效能指標
- 平均翻譯延遲：3.9 秒
- ASR 延遲：2.5-3.5 秒
- 翻譯延遲：0.8-1.3 秒
- TTS 延遲：< 1 秒

---

## 版本規範

本專案遵循 [語義化版本](https://semver.org/lang/zh-TW/) 規範：

- **主版本號（Major）：** 不相容的 API 變更
- **次版本號（Minor）：** 向下相容的功能新增
- **修訂號（Patch）：** 向下相容的問題修正

### 版本號格式
```
主版本號.次版本號.修訂號
例如：1.0.0, 1.1.0, 1.1.1
```

### 版本發布流程
1. 更新 `VERSION_HISTORY.md`
2. 執行完整測試（`pnpm test`）
3. 建立 Git tag（`git tag v1.1.0`）
4. 建立 checkpoint（`webdev_save_checkpoint`）
5. 部署到生產環境

---

## 已知問題

### v1.1.0
1. **對話摘要功能測試失敗**
   - 狀態：🔴 待修復
   - 影響：對話摘要功能無法使用
   - 原因：`server/routers.ts:444` 存在 undefined 錯誤
   - 計劃：v1.1.1 修復

2. **翻譯數量統計錯誤**
   - 狀態：🟡 低優先級
   - 影響：歷史記錄顯示的翻譯數量不正確
   - 原因：翻譯數量計算邏輯有誤
   - 計劃：v1.1.1 修復

3. **ASR 延遲過高**
   - 狀態：🟡 效能優化
   - 影響：翻譯延遲 > 3 秒
   - 原因：Whisper API 回應慢
   - 計劃：v1.2.0 使用 Whisper Streaming API

---

## 未來規劃

### v1.1.1（修復版本）- 預計 2025-12-16
- 修復對話摘要功能
- 修復翻譯數量統計錯誤
- 優化 TTS Profiler 時間閾值

### v1.2.0（功能版本）- 預計 2025-12-20
- 使用 Whisper Streaming API（降低 ASR 延遲 50%）
- 支援更多語言（西班牙語、法語、德語、俄語）
- 建立前端 E2E 測試
- 建立效能監控儀表板

### v1.3.0（功能版本）- 預計 2025-12-25
- 支援多人對話（3+ 人）
- 支援語音情緒分析
- 支援對話摘要自動生成
- 支援對話記錄搜尋功能

### v2.0.0（重大更新）- 預計 2026-01-01
- 重構前端架構（使用 Next.js）
- 重構後端架構（使用 NestJS）
- 支援離線模式
- 支援自定義翻譯模型
- 支援 WebRTC 點對點通訊

---

## 貢獻者

- **Manus AI** - 主要開發者
- **使用者** - 需求提供與測試

---

## 授權

本專案採用 MIT 授權條款。
